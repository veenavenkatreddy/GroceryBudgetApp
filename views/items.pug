extends layout-sidebar

block content
  // Page Header
  .mb-4
    h1.dashboard-title.mb-1 Grocery Items
    p.dashboard-subtitle.text-muted.mb-0 Track and manage your grocery purchases
  
  // Action Bar
  .d-flex.flex-column.flex-lg-row.justify-content-between.align-items-start.align-items-lg-center.mb-4.gap-2
    // Filters
    .d-flex.flex-wrap.gap-2
      select.form-select.form-select-sm#filterCategory(style='width: 200px;')
        option(value='') All Categories
        if categories
          each category in categories
            option(value=category._id)= category.name
      input.form-control.form-control-sm#filterDateFrom(type='date' style='width: 150px;' placeholder='From')
      input.form-control.form-control-sm#filterDateTo(type='date' style='width: 150px;' placeholder='To')
      button.btn.btn-sm.btn-primary(onclick='applyFilters()')
        i.bi.bi-funnel.me-1
        span.d-none.d-md-inline Apply

    // Action Buttons
    .d-flex.flex-wrap.gap-2
      button.btn.btn-success(data-bs-toggle='modal' data-bs-target='#addItemModal')
        i.bi.bi-plus-lg.me-1
        span.d-none.d-md-inline Add Item
      button.btn.btn-outline-primary(data-bs-toggle='modal' data-bs-target='#batchAddModal')
        i.bi.bi-list-task.me-1
        span.d-none.d-md-inline Batch Add
  
  // Items Table Card
  .card.shadow-sm
    .card-header.d-flex.flex-column.flex-md-row.justify-content-between.align-items-md-center
      h5.mb-2.mb-md-0
        i.bi.bi-bag.me-2
        | Items List
      small.text-muted
        span#itemCount 0
        |  items found
    
    .card-body.p-0
      .table-responsive
        table.table.table-hover.mb-0
          thead
            tr
              th(style='width: 40px;')
                input.form-check-input#selectAll(type='checkbox')
              th Item Name
              th Category
              th.text-end Price
              th.text-center Qty
              th.text-end Total
              th Date
              th.text-center Actions
          tbody#itemsTableBody
            // Items loaded dynamically
      
      // Empty State
      .text-center.py-5#emptyState(style='display: none;')
        i.bi.bi-bag-x.display-4.text-muted.mb-3
        h4.mb-1 No items found
        p.text-muted.mb-3 Start tracking your grocery purchases
        button.btn.btn-primary(data-bs-toggle='modal' data-bs-target='#addItemModal')
          i.bi.bi-plus-lg.me-2
          | Add First Item
    
    // Card Footer with Pagination and Actions
    .card-footer.d-flex.flex-column.flex-md-row.justify-content-between.align-items-start.align-items-md-center.gap-2
      // Bulk Actions
      .d-flex.gap-2
        button.btn.btn-sm.btn-outline-danger#bulkDelete(onclick='bulkDeleteItems()' disabled)
          i.bi.bi-trash.me-1
          span.d-none.d-md-inline Delete Selected
        button.btn.btn-sm.btn-outline-secondary#exportSelected(onclick='exportSelectedItems()' disabled)
          i.bi.bi-download.me-1
          span.d-none.d-md-inline Export Selected
      
      // Pagination
      nav
        ul.pagination.pagination-sm.mb-0#pagination
          // Pagination loaded dynamically
  
  // Floating Action Button (Mobile)
  button.fab.d-md-none(data-bs-toggle='modal' data-bs-target='#addItemModal')
    i.bi.bi-plus-lg
  
  // Add Item Modal
  .modal.fade#addItemModal(tabindex='-1')
    .modal-dialog
      .modal-content
        .modal-header
          h5.modal-title Add New Item
          button.btn-close(type='button' data-bs-dismiss='modal')
        .modal-body
          form#addItemForm
            .form-floating.mb-3
              input.form-control#itemName(type='text' placeholder='Item name' required)
              label(for='itemName') Item Name
            
            .row.g-3
              .col-md-6
                .form-floating.mb-3
                  input.form-control#itemPrice(type='number' step='0.01' min='0' placeholder='0.00' required)
                  label(for='itemPrice')= `Price (${CurrencyHelper.getSymbol(userCurrency)})`
              .col-md-6
                .form-floating.mb-3
                  input.form-control#itemQuantity(type='number' min='1' value='1' placeholder='1' required)
                  label(for='itemQuantity') Quantity
            
            .form-floating.mb-3
              select.form-select#itemCategory(required)
                option(value='') Select a category
                if categories
                  each category in categories
                    option(value=category._id)= category.name
              label(for='itemCategory') Category
            
            .form-floating.mb-3
              input.form-control#purchaseDate(type='date' required)
              label(for='purchaseDate') Purchase Date
            
            .form-check.form-switch.mb-3
              input.form-check-input#isEssential(type='checkbox' role='switch')
              label.form-check-label(for='isEssential') Mark as Essential Item
            
            .form-floating
              textarea.form-control#itemNotes(placeholder='Add notes' style='height: 80px;')
              label(for='itemNotes') Notes (Optional)
        
        .modal-footer
          button.btn.btn-secondary(type='button' data-bs-dismiss='modal') Cancel
          button.btn.btn-primary(type='button' onclick='addItem()')
            i.bi.bi-plus-circle.me-2
            | Add Item
  
  // Batch Add Modal
  .modal.fade#batchAddModal(tabindex='-1')
    .modal-dialog.modal-lg
      .modal-content
        .modal-header
          h5.modal-title Batch Add Items
          button.btn-close(type='button' data-bs-dismiss='modal')
        .modal-body
          .alert.alert-info.d-flex.align-items-center
            i.bi.bi-info-circle.me-2
            div
              strong Format: 
              | Name, Price, Quantity, Category (one item per line)
          
          .form-floating
            textarea.form-control#batchItems(style='height: 200px;' placeholder='Enter items...')
              | Milk, 2.50, 2, Dairy
              | Bread, 1.80, 1, Bakery
              | Apples, 3.00, 6, Produce
            label(for='batchItems') Enter items
          
          .mt-3
            h6.fw-bold Instructions:
            ul.small.text-muted
              li Use commas to separate values
              li= `Price should be a number (without ${CurrencyHelper.getSymbol(userCurrency)} symbol)`
              li Quantity defaults to 1 if not specified
              li Category must match existing categories
        
        .modal-footer
          button.btn.btn-secondary(type='button' data-bs-dismiss='modal') Cancel
          button.btn.btn-primary(type='button' onclick='batchAddItems()')
            i.bi.bi-list-check.me-2
            | Add All Items

block scripts
  // Keep your same JS logic from original file â€” it already matches backend endpoints perfectly.
